(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{204:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(33),o=a.n(c),s=a(11),i=(a(88),a(2)),u=a(7),l=a(5),m=(a(89),a(15)),f=a(4),p=a.n(f),d=a(8),h=a(20),b=a.n(h),v="/api/survey",E=null,g={setToken:function(e){E="bearer ".concat(e)},getToken:function(){console.log(E)},getAll:function(){var e=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(v,"/all"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getSingle:function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("http://localhost:3005/api/survey/single/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getResults:function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(v,"/results/").concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(d.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:E}},e.next=3,b.a.post("".concat(v,"/create"),t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateVotes:function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("".concat(v,"/updateVotes"),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var O=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),s=Object(i.a)(o,2),l=s[0],f=s[1],p=Object(n.useState)([]),d=Object(i.a)(p,2),h=d[0],b=d[1],v=Object(n.useState)([]),E=Object(i.a)(v,2),O=E[0],y=E[1];return Object(n.useEffect)((function(){g.getAll().then((function(e){var t=e.surveys,a=e.popular,n=t.sort((function(e,t){return new Date(t.created_at)-new Date(e.created_at)})).slice(0,2),r=new Date,o=t.filter((function(e){return new Date(e.deadline)>r})),s=t.filter((function(e){return r>new Date(e.deadline)}));c(o),f(s),b([].concat(Object(m.a)(h),Object(m.a)(n))),y([].concat(Object(m.a)(O),Object(m.a)(a)))}))}),[]),r.a.createElement("div",{className:"container"},r.a.createElement("img",{src:"/img/happy.jpg",alt:"Sad Muppet Moss from Sesame Streets",className:"homepage-img"}),r.a.createElement("p",null,"This is big data place and you are here.")," ",r.a.createElement("br",null),r.a.createElement("p",null,"Sign up or Log In to create survey. Yup, you are thrilled. I am thrilled. This is amazing. Posibility are endless."," ")," ",r.a.createElement("br",null),r.a.createElement("p",null,"Check ",r.a.createElement(u.b,{to:"#recent"},"recent surveys")," or"," ",r.a.createElement(u.b,{to:"#popular"},"popular surveys")),r.a.createElement("section",{className:"homepage-survey-block",id:"on"},r.a.createElement("p",null,"Active surveys:"),a.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(u.b,{to:"/client/survey/single/".concat(e.id)},e.survey_name))}))),r.a.createElement("section",{className:"homepage-survey-block",id:"off"},r.a.createElement("p",null,"Past surveys:"),l.map((function(e){return r.a.createElement("div",null,r.a.createElement(u.b,{key:e.id,to:"/client/survey/single/".concat(e.id)},e.survey_name))}))),r.a.createElement("section",{className:"homepage-survey-block",id:"recent"},r.a.createElement("p",null,"Most recent surveys:"),h.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(u.b,{to:"/client/survey/single/".concat(e.id)},e.survey_name))}))),r.a.createElement("section",{className:"homepage-survey-block",id:"popular"},r.a.createElement("p",null,"Most popular surveys:"),O.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(u.b,{to:"/client/survey/single/".concat(e.id)},e.survey_name))}))))},y=a(18),j=a(19);var w=function(e){var t=e.user,a=Object(n.useState)(!0),c=Object(i.a)(a,2),o=c[0],l=c[1],m=Object(s.c)((function(e){return e}));return Object(n.useEffect)((function(){m.errors.length>0||m.infos.length>0?l(!1):l(!0)}),[m.errors.length,m.infos.length,t]),r.a.createElement("header",null,r.a.createElement("nav",{roleplay:"navigation"},r.a.createElement("img",{src:"/img/pie.jpg",alt:"Pie Chart Logo",style:{visibility:o?"visible":"hidden"}}),r.a.createElement("div",{className:"nav-links"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"user-name"},r.a.createElement(y.a,{icon:j.b})," ",t),r.a.createElement(u.c,{exact:!0,to:"/",activeClassName:"nav-active"},"Home"),r.a.createElement(u.c,{exact:!0,to:"/client/survey/create",activeClassName:"nav-active"},"Create Survey"),r.a.createElement("button",{className:"user-control",onClick:function(){window.localStorage.clear(),window.location.reload()}},"Log Out")):r.a.createElement(r.a.Fragment,null,r.a.createElement(u.c,{exact:!0,to:"/",activeClassName:"nav-active"},"Home"),r.a.createElement(u.c,{to:"/register",activeClassName:"nav-active"},"Sign Up"),r.a.createElement(u.c,{to:"/login",activeClassName:"nav-active"},"Sign In")))))};var N=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e})),a={display:"flex",justifyContent:"space-between",padding:10,width:"99%",margin:"5px auto"};return r.a.createElement("div",{className:"notification-container"},t.infos&&t.infos.map((function(t){return setTimeout((function(){return e({type:"REMOVE_INFO",id:t.id})}),3e3),r.a.createElement("div",{style:a,key:t.id,className:"info-notification"},r.a.createElement("p",null,t.content),r.a.createElement("div",{className:"btn-notification",onClick:function(){return e({type:"REMOVE_INFO",id:t.id})}},r.a.createElement(y.a,{icon:j.c,className:"btn-info-notification"})))})),t.errors&&t.errors.map((function(t){return setTimeout((function(){return e({type:"REMOVE_ERROR",id:t.id})}),3e3),r.a.createElement("div",{style:a,key:t.id,className:"error-notification"},r.a.createElement("p",null,t.content),r.a.createElement("div",{className:"btn-error-notification",onClick:function(){return e({type:"REMOVE_ERROR",id:t.id})}},r.a.createElement(y.a,{icon:j.c})))})))},S=a(6),k={infos:[],errors:[]},x=function(e){return{type:"NEW_INFO",content:e}},C=function(e){return{type:"NEW_ERROR",content:e}},R=function(){return Math.floor(1e5*Math.random())},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_INFO":return Object(S.a)(Object(S.a)({},e),{},{infos:e.infos.concat({content:t.content,id:"info-".concat(R())})});case"NEW_ERROR":return Object(S.a)(Object(S.a)({},e),{},{errors:e.errors.concat({content:t.content,id:"error-".concat(R())})});case"REMOVE_INFO":return Object(S.a)(Object(S.a)({},e),{},{infos:e.infos.filter((function(e){return e.id!==t.id}))});case"REMOVE_ERROR":return Object(S.a)(Object(S.a)({},e),{},{errors:e.errors.filter((function(e){return e.id!==t.id}))});case"RESET":return k;default:return e}},_=function(){return Math.floor(1e5*Math.random())};var M=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),u=Object(i.a)(o,2),f=u[0],h=u[1],b=Object(l.f)(),v=Object(s.b)();Object(n.useEffect)((function(){console.log(f)}),[f]);var E=function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,n=[],a||n.push("Select survey's title missing"),a.length>100&&n.push("Title is too long"),0===(r=(r=f.map((function(e){return e.title||n.push("Title is missing"),e.choices.forEach((function(e){if(e.choice||n.push("Choice is empty"),e.choice.length>30&&n.push("Choice must be 30 characters long"),n.length>0)throw n})),{type:"radiogroup",name:e.title,title:e.title,isRequired:!0,colCount:1,choices:e.choices.map((function(e){return e.choice&&e.choice})).filter(Boolean)}}))).filter(Boolean)).length&&n.push("Questions and choices are missing"),!(n.length>0)){e.next=10;break}throw n;case 10:return c=JSON.stringify(r),e.next=13,g.create({survey:c,title:a});case 13:v(x("Your Survey is successfully created")),b.push("/"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),Array.isArray(e.t0)?e.t0.map((function(e){return v(C(e))})):v(C(e.t0.response.data.message));case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("main",{className:"create-survey-container"},r.a.createElement("form",{onSubmit:E,className:"create-form"},r.a.createElement("label",null,r.a.createElement("small",{className:"survey-title"},"Survey Title"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return c(e.target.value)}})),f.map((function(e,t){var a="title".concat(t);return r.a.createElement("div",{key:e.id,className:"new-question"},r.a.createElement("label",null,r.a.createElement("small",null,"Question name"),r.a.createElement("input",{type:"text",name:a,onChange:function(t){return function(e,t){try{h(f.map((function(a){return a.id===t?Object(S.a)(Object(S.a)({},a),{},{title:e.target.value,choices:Object(m.a)(a.choices)}):a})))}catch(a){v(C(a.message))}}(t,e.id)},autoFocus:!0})),r.a.createElement("button",{onClick:function(){return function(e){try{h(f.filter((function(t){return e!==t.id})))}catch(t){v(C(t.message))}}(e.id)},className:"close-elem-button",key:t},r.a.createElement(y.a,{icon:j.a})),e.choices.map((function(t,a){var n="choice".concat(a);return r.a.createElement("div",{className:"new-choices",key:t.id},r.a.createElement("label",null,r.a.createElement("small",null,"Add Choice"),r.a.createElement("input",{type:"text",className:"input-choice",name:n,placeholder:"Choice Option",onChange:function(a){return function(e,t,a){try{if(e.target.value.length>30)throw new Error("Max choice length is 30 characters");h(f.map((function(n){return n.id===t?Object(S.a)(Object(S.a)({},n),{},{choices:n.choices.map((function(t,n){return t.id===a?Object(S.a)(Object(S.a)({},t),{},{choice:e.target.value}):t}))}):n})))}catch(n){v(C(n.message))}}(a,e.id,t.id)},autoFocus:!0})),r.a.createElement("button",{className:"close-elem-button",onClick:function(){return function(e,t){h(f.map((function(a){return a.id===e?Object(S.a)(Object(S.a)({},a),{},{choices:a.choices.filter((function(e){return e.id!==t}))}):a})))}(e.id,t.id)}},r.a.createElement(y.a,{icon:j.a})))})),r.a.createElement("button",{className:"btn-form",onClick:function(t){return function(e,t){e.preventDefault();try{h(f.map((function(e){if(e.id===t&&e.choices.length>=8)throw new Error("You can add up to 8 choices");return e.id===t?Object(S.a)(Object(S.a)({},e),{},{choices:e.choices.concat({id:_(),choice:""})}):e})))}catch(a){v(C(a.message))}}(t,e.id)}},"Add Choice"))})),r.a.createElement("button",{onClick:function(e){e.preventDefault();try{if(f.length>=5)throw new Error("You can add up to 5 question");h(f.concat({id:_(),title:"",choices:[]}))}catch(t){v(C(t.message))}},className:"btn-form"},"Add Question"),r.a.createElement("button",{className:"btn-form submit"},"Submit")))},A=a(37),I=a(78);var D=function(e){var t=e.id,a=e.title,c=Object(n.useState)([]),o=Object(i.a)(c,2),s=o[0],u=o[1],l=Object(n.useState)([]),f=Object(i.a)(l,2),p=f[0],d=f[1];function h(e){for(var t=[];t.length<=e;){var a="#"+((1<<24)*Math.random()|0).toString(16);t.push(a)}return t}return Object(n.useEffect)((function(){g.getResults(t).then((function(e){var t=Object(m.a)(new Set(e.map((function(e){return e.question_name}))));d([].concat(Object(m.a)(p),Object(m.a)(t)));for(var a=Array.from({length:t.length},(function(e,a){return{question:t[a],labels:[],data:[]}})),n=function(t){e.forEach((function(e){e.question_name===a[t].question&&(a[t].labels.push(e.choice),a[t].data.push(e.score))}))},r=0;r<a.length;r++)n(r);u(s.concat(a.map((function(e){return{labels:e.labels,datasets:[{label:"level of something",data:e.data,backgroundColor:h(e.data.length),borderWidth:4}]}}))))}))}),[]),r.a.createElement("div",{className:"charts"},r.a.createElement("p",{className:"chart-title"},r.a.createElement("small",null,a)),s.map((function(e,t){return r.a.createElement("div",{key:t,className:"chart"},r.a.createElement("h2",{className:"chart-question"},p[t]),r.a.createElement(I.Pie,{data:e,options:{responsive:!0,responsiveAnimationDuration:1e3}}))})))};var V=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),u=Object(i.a)(s,2),m=u[0],f=u[1],p=Object(n.useState)({}),d=Object(i.a)(p,2),h=d[0],b=d[1],v=Object(n.useState)(""),E=Object(i.a)(v,2),O=E[0],y=E[1],j=Object(n.useState)(!1),w=Object(i.a)(j,2),N=w[0],S=w[1],k=Object(l.g)().id;return Object(n.useEffect)((function(){g.getSingle(k).then((function(e){var t=JSON.parse(e.surveyString);b({questions:t}),y(e.surveyTitle)}))}),[k]),Object(n.useEffect)((function(){window.localStorage.getItem("chartVoted-".concat(k))&&f(!0)}),[]),r.a.createElement("main",{className:"survey-page"},c&&r.a.createElement("p",{className:"survey-finished"}),m?r.a.createElement("div",{className:"just-results"},r.a.createElement(D,{id:k,title:O})):r.a.createElement(r.a.Fragment,null,r.a.createElement(A.Survey,{json:h,showCompletePage:!1,onComplete:function(e){return function(e){g.updateVotes({data:e.data,id:k}),window.localStorage.setItem("chartVoted-".concat(k),!0),o(!0),setTimeout((function(){window.location.reload()}),1100)}(e)}}),r.a.createElement("div",{className:"show-results"},r.a.createElement("button",{className:"btn-results",onClick:function(){return S(!N)}},N?"Hide Charts":"Show Charts"),N&&r.a.createElement("div",null,r.a.createElement(D,{id:k,title:O})))))},F={register:function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("/api/users",t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),login:function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var P=function(e){var t=e.user,a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],u=c[1],m=Object(n.useState)(""),f=Object(i.a)(m,2),h=f[0],b=f[1],v=Object(n.useState)(""),E=Object(i.a)(v,2),g=E[0],O=E[1],y=Object(s.b)(),j=Object(l.f)();Object(n.useEffect)((function(){t&&j.push("/")}));var w=function(){var e=Object(d.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,a=[],h!==g&&a.push("Password Confirmation does not match!"),0===a.length){e.next=6;break}throw a;case 6:return e.next=8,F.register({username:o,password:h});case 8:return e.next=10,F.login({username:o,password:h});case 10:n=e.sent,r=JSON.stringify(n),window.localStorage.setItem("loggedUser",r),y(x("Now you are registered user!")),setTimeout((function(){j.push("/"),window.location.reload()}),2500),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),Array.isArray(e.t0)?e.t0.forEach((function(e){return y(C(e))})):e.t0&&e.t0.response&&y(C(e.t0.response.data.message));case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"credentials-container"},r.a.createElement("form",{onSubmit:w},r.a.createElement("small",null,"Username"),r.a.createElement("input",{type:"text",value:o,onChange:function(e){return u(e.target.value)}})," ",r.a.createElement("br",null),r.a.createElement("small",null,"Password"),r.a.createElement("input",{type:"password",value:h,onChange:function(e){return b(e.target.value)}})," ",r.a.createElement("br",null),r.a.createElement("small",null,"Confirm Password"),r.a.createElement("input",{type:"password",value:g,onChange:function(e){return O(e.target.value)}})," ",r.a.createElement("br",null),r.a.createElement("button",null,"Register")))};var q=function(e){var t=e.user,a=Object(s.b)(),c=Object(l.f)();Object(n.useEffect)((function(){t&&c.push("/")}),[t,c]);var o=Object(n.useState)(""),u=Object(i.a)(o,2),m=u[0],f=u[1],h=Object(n.useState)(""),b=Object(i.a)(h,2),v=b[0],E=b[1],g=Object(n.useState)(!1),O=Object(i.a)(g,2),y=O[0],j=O[1];function w(){return(w=Object(d.a)(p.a.mark((function e(t){var n,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=[],e.prev=2,m||n.push("Username is missing"),v||n.push("Password is missing"),0===n.length){e.next=7;break}throw n;case 7:return e.next=9,F.login({username:m,password:v});case 9:r=e.sent,o=JSON.stringify(r),window.localStorage.setItem("loggedUser",o),a(x("Hello ".concat(m))),setTimeout((function(){c.push("/"),window.location.reload()}),1500),j(!0),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),Array.isArray(e.t0)?e.t0.forEach((function(e){a(C(e))})):e.t0.response&&e.t0.response.data?a(C(e.t0.response.data.message)):a(C(e.t0.message));case 20:case"end":return e.stop()}}),e,null,[[2,17]])})))).apply(this,arguments)}return r.a.createElement("div",{className:"credentials-container"},!y&&r.a.createElement("form",{onSubmit:function(e){return w.apply(this,arguments)}},r.a.createElement("label",null,"Username:"),r.a.createElement("input",{type:"text",value:m,onChange:function(e){return f(e.target.value)}})," ",r.a.createElement("br",null),r.a.createElement("label",null,"Password: "),r.a.createElement("input",{type:"password",value:v,onChange:function(e){return E(e.target.value)}})," ",r.a.createElement("br",null),r.a.createElement("button",null,"Login")))};var J=function(){return r.a.createElement("div",{className:"mainbox"},r.a.createElement("h1",{style:{fontSize:"5em",color:"red"}},"404"),r.a.createElement("h1",null,"There is no page you are looking for!"),r.a.createElement("p",{style:{marginTop:10}},"Back to ",r.a.createElement("a",{href:"/"},"Home")," "))};A.StylesManager.applyTheme("modern");var U=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem("loggedUser"));e&&e.username&&(g.setToken(e.token),c(e.username))}),[]),r.a.createElement(u.a,null,r.a.createElement(w,{user:a}),r.a.createElement(N,null),r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/client/survey/create",component:M}),r.a.createElement(l.a,{exact:!0,path:"/client/survey/single/:id",component:V}),r.a.createElement(l.a,{path:"/register",component:P}),r.a.createElement(l.a,{path:"/login",component:q}),r.a.createElement(l.a,{exact:!0,path:"/",component:O}),r.a.createElement(l.a,{path:"*",component:J})))},H=a(35),W=Object(H.b)(T);o.a.render(r.a.createElement(s.a,{store:W},r.a.createElement(U,null)),document.getElementById("root"))},79:function(e,t,a){e.exports=a(204)},88:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.8fc58ae2.chunk.js.map